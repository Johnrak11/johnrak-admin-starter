<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cloudflare R2 Backup Setup</title>
  <style>
    :root { color-scheme: light dark; }
    body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; margin: 0; padding: 24px; line-height: 1.6; }
    .container { max-width: 800px; margin: 0 auto; }
    h1 { font-size: 1.5rem; margin-bottom: 0.75rem; }
    h2 { font-size: 1.1rem; margin-top: 1.25rem; margin-bottom: 0.5rem; }
    code { padding: 2px 4px; border-radius: 6px; background: rgba(0,0,0,0.06); font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; font-size: 0.9em; }
    pre { padding: 12px; border-radius: 12px; background: rgba(0,0,0,0.06); overflow-x: auto; }
    ul, ol { padding-left: 1.25rem; }
    .muted { color: #6b7280; }
    .step { margin-bottom: 1.5rem; }
    .highlight { background-color: #e0f2fe; padding: 2px 4px; border-radius: 4px; color: #0c4a6e; }
  </style>
  <meta name="robots" content="noindex" />
</head>
<body>
  <div class="container">
    <h1>Cloudflare R2 Backup Setup</h1>
    <p class="muted">Follow this guide to configure your admin panel to back up databases to Cloudflare R2 automatically.</p>

    <h2>1. Create R2 Bucket</h2>
    <ol>
      <li>Log in to the <a href="https://dash.cloudflare.com/" target="_blank">Cloudflare Dashboard</a>.</li>
      <li>Navigate to <strong>R2</strong> from the sidebar.</li>
      <li>Click <strong>Create Bucket</strong>.</li>
      <li>Give it a unique name (e.g., <code>johnrak-backups</code>) and click <strong>Create Bucket</strong>.</li>
      <li>Go to the <strong>Settings</strong> tab of your new bucket.</li>
      <li>Copy the <strong>S3 API</strong> URL. It looks like:<br><code>https://<ACCOUNT_ID>.r2.cloudflarestorage.com/johnrak-backups</code></li>
      <li><strong>Important:</strong> Remove the bucket name from the end. Your <strong>Endpoint URL</strong> is just:<br><code>https://<ACCOUNT_ID>.r2.cloudflarestorage.com</code></li>
    </ol>

    <h2>2. Create API Tokens</h2>
    <ol>
      <li>Go back to the main R2 page.</li>
      <li>Click <strong>Manage R2 API Tokens</strong> on the right side.</li>
      <li>Click <strong>Create API Token</strong>.</li>
      <li>Select <strong>Admin Read & Write</strong> permissions (or Object Read & Write).</li>
      <li>Set "Apply to" to <strong>All buckets</strong> or specific bucket.</li>
      <li>Click <strong>Create API Token</strong>.</li>
      <li>Copy the <strong>Access Key ID</strong> and <strong>Secret Access Key</strong> immediately. You won't see them again!</li>
    </ol>

    <h2>3. Configure Admin Panel</h2>
    <ol>
      <li>Go to your Admin Dashboard → <strong>System</strong> → <strong>Backups</strong>.</li>
      <li>Select Provider: <strong>Cloudflare R2</strong>.</li>
      <li>Bucket Name: Enter the name from Step 1 (e.g., <code>johnrak-backups</code>).</li>
      <li>Endpoint URL: Paste the URL from Step 1 (without bucket name).</li>
      <li>Region: Leave as <code>auto</code>.</li>
      <li>Access Key ID & Secret Key: Paste from Step 2.</li>
      <li>Click <strong>Save Configuration</strong>.</li>
    </ol>

    <h2>4. Test & Enable</h2>
    <ol>
      <li>Click <strong>Run Manual Backup</strong> to verify credentials.</li>
      <li>If successful, toggle <strong>Enable Automated Backups</strong> and save again.</li>
      <li>Your database will now be backed up daily!</li>
    </ol>

    <h2>Notes</h2>
    <ul>
      <li>R2 has no egress fees, making it perfect for backups!</li>
      <li>Ensure your Laravel scheduler/cron is running for automation to work.</li>
    </ul>
  </div>
</body>
</html>
